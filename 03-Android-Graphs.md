# Graphs from Android Code

## Topics

* Scraping benign Android applications.
* Creating graphs from Smali code.
* Differentiating app types from graph statistics.

## Readings, Task, and Analyses

* Create a dataset of Android applications. Do this select apps from
  apkpure using the
  [sitemap.xml](https://apkpure.com/sitemap.xml). Downloading an app
  from apkpure using Python's `requests` module requires a multiple
  steps: first visiting the download page for an app, then using the
  url for the button 'If the download doesn't start, [click
  here]()'.
  
* Read the
  [HinDroid](https://www.cse.ust.hk/~yqsong/papers/2017-KDD-HINDROID.pdf)
  paper through section 3.1 (feature extraction). Create feature
  extraction code that transforms Smali code into the graph described
  in the article.
  
* Stretch task: the data ingestion and feature extraction code
  in the first two steps creates graphs from apps on apkpure. Select
  apps of two different types (e.g. games and productivity apps),
  calculate graph statistics/features and see if you can classify the
  app type using a classifier in scikit-learn. Try to brainstorm
  features with others and look at networkX methods for possible graph
  statistics to calculate.

*Note:* a few notes on writing the data ingestion code:

* For downloading and parsing sitemap.xml, the zip file can be opened
  in python with the `gzip` library, and the resulting xml file can be
  parsed using `ElementTree`. This behaves similarly to
  `BeautifulSoup`.
* Once the app is downloaded using requests, the contents of the
  response can be save to file as follows:
```
resp = requests.get('url/to/app/download')
data = resp.content
with open('my_new_app.apk', 'wb') as fh:
    fh.write(data)
```

## Additional Reading (Optional)

For more information on the structure of APKs and Android Bytecode
(e.g. Smali), see this
[paper](https://arxiv.org/pdf/1808.04218.pdf). We will return to the
contents of this paper later in the quarter.

## Questions on the tasks

* What app behaviors are the edges of the graph in the Hindroid paper
  trying to capture? What valuable information does the graph lose?
* For the app-type classification problem, what non-graph based
  features might be helpful? Can you combine these features with graph
  features such as degree?
  

### Participation Submission

Answer the questions on this
[Form](https://forms.gle/HiLaZiWZimSWLLwk8) by the Tuesday morning
before section.
